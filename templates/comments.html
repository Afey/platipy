{% extends 'base.html' %}
{% block body %}
    {% if github_name == None %}
    <form action="/authenticate" target="_blank">
        <button type="submit" class="btn btn-default btn-sm">
            Sign in to github
        </button>
    </form>
    {% else %}
    Logged in to github as: {{github_name}}   
    {% endif %}

    <br />

    <div>
        <div style="float: left">
            {% if section %}
                {{section.num_favorites}}
            {% else %}
                0
            {% endif %}
        </div>
        {% if favorite %}
            <form method="POST" action="/favorite">
                <input type="hidden" name="html_section" value="{{html_section}}"> </input>
                <input type="hidden" name="favorited_status" value="true"></input>
                <button type="submit" class="btn btn-default btn-xs" id="yellow_star" style="float:left">
                    <span class="glyphicon glyphicon-star"></span>
                </button> 
            </form>
        {% else %}
            <form method="POST" action="/favorite">
                <input type="hidden" name="html_section" value="{{html_section}}"> </input>
                <input type="hidden" name="favorited_status" value="false"></input>
                <button type="submit" class="btn btn-default btn-xs" id="white_star" style="float: left">
                    <span class="glyphicon glyphicon-star-empty">
                </button>
            </form>
        {% endif %}

        <form method="POST" style="padding-left: 10px;">
            <textarea name="comment" class="form-control" rows="3" cols="300"></textarea>
            <button type="submit" class="btn btn-default btn-sm">
                Submit
            </button>
        </form>
    </div>

    <div>

        {% for comment in section.comment %}
            <div class="row">
                <div class="col-sm-1">
                    <form method="POST" action="/vote">
                        <input type="hidden" name="comment_id" value="{{comment.id}}"></input>
                        <input type="hidden" name="html_section" value="{{html_section}}"> </input>
                        <button
                            type="submit"
                            class="btn btn-default btn-xs btn-block btn-link"
                            name="vote"
                            value="up">
                            <span class="glyphicon glyphicon-circle-arrow-up"></span>
                        </button>
                        <div class="text-center">{{comment.rating}}</div>
                        <button 
                            type="submit" 
                            class="btn btn-default btn-xs btn-block btn-link" 
                            name="vote" 
                            value="down">
                            <span class="glyphicon glyphicon-circle-arrow-down"></span>
                        </button>
                    </form>
                </div>
                <div class="col-sm-11">
                    <strong class="text-muted">
                        {{comment.created_at|datefilter}} by 
                        <a href="http://github.com/{{comment.user.github_name}}" target="_blank">
                            {{comment.user.github_name}}
                        </a>
                    </strong>
                    <p>{{comment.comment}}</p>
                    {# {{comment.comment|codefilter|safe}} #}
                </div>
            </div>
        {% endfor %}
    </div>

{% endblock %}